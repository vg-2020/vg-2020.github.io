---
layout: post
title: "实时会议系统需要什么"
date: 2020-11-21 00:01:00 -0000
categories: media
tag: [tech, conference]
---
>COVID-19让在线实时音视频系统火了把,国内外玩家不少。搭建一个实时会议系统要什么呢？不是有WebRTC开源的SDK吗，是不是很简单呢？

目前玩家
===============
目前分几类，
- 一类是提供服务(CaaS(Communications-as-a-service))
    - 供其它app集成，降低门槛，第三方自己的app里提供音视频通讯功能
    - 声网,网易云信，腾讯云
- 一类是直接通过产品(SaaS(Software as a service))。
    - 钉钉, Zoom, Cisco/WebEx, 字节飞书, 腾讯会议
- 提供产品加服务
    - 腾讯

>注: 当然一些产品并不是仅仅是一个实时通讯系统，而是开放协作平台例如钉钉,允许其它应用在上面集成，例如可以在钉钉上用其它提供上的会议系统开会。

需要做什么
===============

如果只是采用云音视频服务，那简单，云音视频服务会提供SDK, easy to use/integration 是一个SDK的基本需求。
如果自己做要做什么呢。 粗的话包括几个大的方面。
- 音视频 MediaSDK: 提供核心音视频功能。
    >WebRTC就是一个实现，目前大部分都是基于WebRTC code基础上做修改。 做简单的封装？也有公司是自己全实现，但投入太大，一般都是公司本来就有遗留下的MediaSDK。
    - [WebRTC Introduce]({% post_url 2020-11-20-webrtc-introduce %})
- 音视频媒体服务器Media-Server: 
    - 根据媒体架构需求，需要不同的服务器，参考[媒体架构]({% post_url 2020-11-24-realtime-conference-arch %})类型
    - 除核心的媒体服务，还要一些辅助媒体服务器
        - 录制播放服务器
            - 录制不仅仅是音视频媒体流，还包括其它的例如会议里的chat message， note 等。
            - 对应播放也是不仅仅是音视频媒体流，包括其它
            - 聚合不同的数据，提供服务给palyerback
        - 直播流服务器
            - 支持超大会议例如10K+参与者，这个不需要那么实时交互的，一般都是单向的。等同直播
            - 一些录制播放直接就用流服务器提供。 
    - 媒体服务器节点管理服务器
        - 媒体服务器注册到管理服务器。
        - 根据用户位置，媒体服务器节点负载，为终端选择具体媒体服务器去连接
        - 维护会议信息状态，建立媒体服务器节点间的级连(cascade-link)
- 信令服务器(Signaling-Server)
    - 媒体服务本身是非常标准的，信令服务虽然也有标准,但是版本多及其一些老的遗留的协议(SIP,Jingle, H323等)没统一. 这也是WebRTC 并没有去定义signalling 协议，只是定义媒体部分。而且现在大部分互联网厂商都是用内部专有的基于restful信令协议。但传统的硬件会议系统终端有不同的标准信令，要和硬件设备(IP电话,网真系统等)互通，需要信令网关服务器，支持不同的信令协议。
        - SIP
        - H.323
        - 其它
- 基础设施
音视频会议系统要求更高的实时低延时需求，对系统网络有更高的要求。
    - 数据中心运维，监控
    - 灾难恢复,故障切换(failover)，避免single point of failur(SPOF)
        > 和其它service服务一样，可用性达到几个9.
    - 动态扩展，内部数据中心或外部运基础提供商(尤其开发新区域市场，都是先用外部公共云提供商)。
    - 高实时需求也需要部署媒体服务器到用户网络
        > 使用场景很多这样的需求，例如开个大会，一个办公楼有300/400人，如果都连到cloud，用户出口带宽都有问题，如果能在用户内部部署媒体服务器节点，出口带宽就减少。其它的公司内部在线会议也不用占用出口带宽。
    - ...
